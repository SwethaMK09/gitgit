import android.app.usage.UsageStats
import android.app.usage.UsageStatsManager
import android.content.Context
import android.os.Build
import android.os.Bundle
import androidx.annotation.RequiresApi
import androidx.appcompat.app.AppCompatActivity
import kotlinx.android.synthetic.main.activity_main.*

class UsageStatsActivity : AppCompatActivity() {

    @RequiresApi(Build.VERSION_CODES.LOLLIPOP)
    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
        setContentView(R.layout.activity_main)

        // Replace "com.example.yourapp" with the package name of the app you want to monitor
        val appPackageName = "com.example.yourapp"

        val usageStatsManager =
            getSystemService(Context.USAGE_STATS_SERVICE) as UsageStatsManager

        val endTime = System.currentTimeMillis()
        val beginTime = endTime - 1000 * 60 * 60 // For the last 1 hour

        val usageStatsList =
            usageStatsManager.queryUsageStats(
                UsageStatsManager.INTERVAL_DAILY,
                beginTime,
                endTime
            )

        // Filter the results based on the package name
        val filteredUsageStatsList = usageStatsList.filter { it.packageName == appPackageName }

        // Display usage stats
        displayUsageStats(filteredUsageStatsList)
    }

    private fun displayUsageStats(usageStatsList: List<UsageStats>) {
        // Process and display usage stats as needed
        if (usageStatsList.isNotEmpty()) {
            val totalForegroundTime = usageStatsList.sumBy { it.totalTimeInForeground.toInt() }

            // Display or process the information accordingly
            // (e.g., update UI, log, send to another app)
            textViewUsageStats.text = "Total Usage Time: $totalForegroundTime milliseconds"
        } else {
            textViewUsageStats.text = "No usage stats available for the specified app."
        }
    }
}



<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:paddingBottom="@dimen/activity_vertical_margin"
    android:paddingLeft="@dimen/activity_horizontal_margin"
    android:paddingRight="@dimen/activity_horizontal_margin"
    android:paddingTop="@dimen/activity_vertical_margin"
    tools:context=".UsageStatsActivity">

    <TextView
        android:id="@+id/textViewUsageStats"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_centerInParent="true"
        android:text="Usage Stats Will Appear Here"
        android:textSize="18sp" />

</RelativeLayout>
